```markdown
# Technical Implementation Plan ‚Äì ‚ÄúFishing In The Deep‚Äù (Single HTML Playable)

This plan targets a **single self-contained HTML file** (HTML + CSS + JS inline) suitable for a mobile/web playable ad. No external dependencies unless inlined (e.g., minimal base64 images or inline SVG). 3D visuals will be **fake-3D** using CSS transforms and gradients; no WebGL or heavy engines.

---

## 1. Core Systems & Architecture

### 1.1 Overall Architecture

- **Single HTML file**:
  - `<head>`: styles in `<style>`, simple meta viewport, optional basic font.
  - `<body>`: main game container, HUD, fake-3D scene elements, overlays.
  - `<script>`: all logic in one `<script>` tag.

- **Core modules (implemented as JS objects / factory functions)**:
  1. `GameState` ‚Äì game-wide data and phase management.
  2. `UIManager` ‚Äì handles HUD, counters, upgrade buttons, gauge, tutorial texts, summary panel.
  3. `FishingController` ‚Äì manages fishing rounds, hook movement (down/up), drag control, camera following, depth mapping, and fish collection.
  4. `FishManager` ‚Äì spawns fish along the depth, handles rarity, worth, catch logic, and animations.
  5. `AnimationManager` ‚Äì `requestAnimationFrame` loop, tweens, easing helpers.
  6. `UpgradeSystem` ‚Äì upgrade purchase, cost progression, applying effects (max fish/depth).
  7. `Effects` ‚Äì coin bursts, floating text, bouncy feedback.

Implement each as closures or simple ES6 classes within the script, but avoid complex bundler patterns.

### 1.2 Game Loop & Timing

- Use **one main `requestAnimationFrame` loop** that:
  - Computes `deltaTime`.
  - Updates systems in order:
    - `FishingController.update(dt)`
    - `FishManager.update(dt)`
    - `AnimationManager.updateTweens(dt)` (generic tween/animation bookkeeping)
  - Renders:
    - Update DOM transforms for hook, camera container, fish positions, coin/fish counters progress bar, etc.
- Keep all animation durations explicit (e.g., for easing, hold times) so design tuning is easy.

### 1.3 State Machine (High-Level Phases)

Game states (string enum in `GameState.phase`):

1. `"LOBBY"` ‚Äì pre-fishing; upgrades visible; Play button + gauge active.
2. `"GAUGE_SELECT"` ‚Äì pointer moving; waiting for tap to lock depth and start fishing.
3. `"HOOK_DESCENDING"` ‚Äì hook moving down; camera following; coin counter replaced by fish counter.
4. `"HOOK_AT_DEPTH"` ‚Äì brief hold; tutorial only on first round.
5. `"HOOK_ASCENDING"` ‚Äì hook moving up; player drags horizontally; collects fish.
6. `"RETURNING_FAST"` ‚Äì hook speeds to surface after max fish reached.
7. `"AT_SURFACE_RESOLVE"` ‚Äì play fish summary animations and reward coins.
8. `"ROUND_END"` ‚Äì prepare next round or end screen if after 3rd round.
9. `"END_SCREEN"` ‚Äì final screen showing total coins and call‚Äëto‚Äëaction (if needed).

`GameState.round` goes from `1` to `3`.

---

## 2. Gameplay Flow

### 2.1 Initial Setup

- Start on `"LOBBY"`:
  - `coins = 100`.
  - `maxFish = 6`.
  - `maxDepth = 5` (meters).
  - `caughtFishThisRound = []`.
  - Gauge pointer set to start position.
  - fish counter hidden; coin counter visible.

### 2.2 Pre-Fishing (Lobby Flow)

1. Player sees:
   - Coin counter (‚Äú100‚Äù + coin icon).
   - Upgrade panel:
     - **Max Fish**: shows current (6) and next (7 for 50ü™ô).
     - **Max Depth**: shows current (5m) and next (10m for 50ü™ô).
   - Play button with gauge under/above it.

2. Player may:
   - Tap `Max Fish` upgrade:
     - If coins ‚â• cost and not at max level:
       - Deduct coins, increase `maxFish`.
       - Next tier cost & label updated.
       - Disable/badge as max when 10 fish reached.
   - Tap `Max Depth` upgrade:
     - Similar logic up to 30m.

3. Tap **Play** (or anywhere on gauge):
   - Transition to `"GAUGE_SELECT"`.
   - Pointer starts pendulum movement automatically if not already moving.

### 2.3 Gauge to Depth Mapping

- Gauge logic:
  - Pointer oscillates between 0% and 100% with sine-based easing at ends.
  - When player taps during `"GAUGE_SELECT"`:
    - `normalized = pointerPosition` in [0, 1].
    - Depth range: `[maxDepth - 2, maxDepth]` (clamped to >= 0).
    - `selectedDepth = (maxDepth - 2) + normalized * 2`.
  - Pass `selectedDepth` to `FishingController.startFishingRound(depth)`.

### 2.4 Hook Descending

1. On start:
   - Phase -> `"HOOK_DESCENDING"`.
   - Hide coin counter, show fish counter:
     - Counter starts at 0 / `maxFish`.
     - Progress bar from 0% filled.
   - Setup fish field based on `maxDepth` (see FishManager below).

2. Hook:
   - Initial position near water surface (y=0).
   - Target position at `selectedDepth` (convert meters to y coordinates).
   - Camera container (scene wrapper) moves with hook vertically to simulate camera following.
   - Animate downward over a fixed time derived from depth (e.g., `time = base + k*depth`).

### 2.5 Hook At Depth

- When hook reaches target:
  - `phase = "HOOK_AT_DEPTH"`.
  - Hold for:
    - First round: 2s and show tutorial text ‚ÄúDrag to move hook and catch fish‚Äù.
    - Other rounds: 0.5‚Äì1s without tutorial.
- After wait, automatically transition to `"HOOK_ASCENDING"`.

### 2.6 Hook Ascending & Player Control

1. Ascend:
   - Hook moves up at a fixed speed from `selectedDepth` back to surface (y=0).
   - Vertical motion auto-driven.
2. Player control:
   - Horizontal movement via pointer/touch:
     - On `touchstart/mousedown`, record starting x.
     - On move events, set hook x within allowed range (clamped).
   - Optionally smooth horizontal following (lerp) for better feel.
3. Fish catching:
   - Every frame, check each fish:
     - If fish not already caught and:
       - |fish.x - hook.x| < catchThresholdX AND |fish.y - hook.y| < catchThresholdY
     - Mark fish caught:
       - Attach fish DOM under hook (or visually move fish to hook position; can offset to ‚Äústack‚Äù).
       - Calculate its value & rarity.
       - Increment fish counter.
       - Update progress bar (caught / `maxFish`).
       - Trigger catch feedback:
         - Small scale bounce of hook+fish.
         - Floating text: `+<value>` and any rarity tag (‚ÄúRARE!‚Äù, etc.).
   - When `caughtCount == maxFish`:
     - Immediately transition to `"RETURNING_FAST"`.

### 2.7 Return Fast to Surface

- `"RETURNING_FAST"`:
  - Increase ascent speed (e.g., 2‚Äì3x).
  - Disable further fish collisions (ignore).
  - Just before reaching surface (e.g., y <= small threshold):
    - Swap fish counter back to coin counter (but don‚Äôt yet update coins).
- On reaching surface (y=0):
  - Phase -> `"AT_SURFACE_RESOLVE"`.

### 2.8 At Surface ‚Äì Result & Rewards

1. Summary animations:
   - For each fish in `caughtFishThisRound`:
     - Animate its icon (cloned or moved) with a small jump/bounce.
     - Show floating text:
       - `+value` near fish.
       - Additional label if rarity.
     - `Coins burst`: small circle/coin sprites that fly outward and fade.
   - Calculate `roundTotal` (sum of fish values).

2. Final summary:
   - Show summary box overlay:
     - Title: ‚ÄúCatch Summary‚Äù.
     - List of fish types and values or just a single total for simplicity.
     - A big `+roundTotal` count up animation.
     - ‚ÄúCoins fly‚Äù effect:
       - Animated small coin elements move from summary total to the coin counter position.
   - Update `GameState.coins += roundTotal`.

3. After animations:
   - Hide summary overlay.
   - If `round < 3`:
     - Increment `round`.
     - Reset hook, fish, UI.
     - Go back to `"LOBBY"`.
   - Else:
     - Transition to `"END_SCREEN"`:
       - Show final coins and message (e.g., ‚ÄúYou earned X coins in 3 casts!‚Äù).
       - Optionally a CTA button (e.g., ‚ÄúPlay Full Game‚Äù).

---

## 3. Entities & Data

### 3.1 Game State Data Structure

```js
const GameState = {
  phase: 'LOBBY',
  round: 1,
  maxRounds: 3,

  coins: 100,
  maxFish: 6,
  maxDepth: 5, // in meters

  // Upgrades definitions
  fishUpgradeLevels: [6, 7, 8, 9, 10],
  fishUpgradeCosts: [0, 50, 100, 200, 400],
  depthUpgradeLevels: [5, 10, 15, 20, 30],
  depthUpgradeCosts: [0, 50, 75, 150, 300],
  currentFishUpgradeIndex: 0,
  currentDepthUpgradeIndex: 0,

  // Round data
  selectedDepth: 0,
  caughtFishThisRound: [], // array of FishEntity
};
```

### 3.2 Fish Entity

```js
class Fish {
  constructor(opts) {
    this.id = opts.id;
    this.type = opts.type; // 'common' | 'rare' | 'epic' | 'legendary'
    this.value = opts.value; // coins
    this.depth = opts.depth; // meter
    this.x = opts.x; // scene units
    this.y = opts.y; // scene units (derive from depth)
    this.caught = false;
    this.dom = opts.domElement; // reference to DOM element
  }
}
```

- **Type ‚Üí Rarity mapping**:
  - `common`: shallow, small value, frequent.
  - `rare`: deeper, moderate value.
  - `amazing`/`epic`: deeper, high value, lower chance.
  - `legendary`: deepest ranges, high value, low chance.
- Probability distribution changes with depth:
  - For each fish spawn, choose type based on `depth`:
    - 0‚Äì10m: mostly common, small chance rare.
    - 10‚Äì20m: mix of common, rare, some amazing.
    - 20‚Äì30m: more rare, amazing, small chance legendary.

### 3.3 Fish Field Generation

- Before each round:
  - `FishManager.generateField(maxDepth)`:
    - Decide total fish count based on depth (e.g., 15‚Äì30 fish).
    - For each fish:
      - Random depth in [0, maxDepth].
      - Map to vertical coordinate.
      - Random horizontal x in [-maxX, maxX].
      - Choose rarity by probability vs depth.
      - Value by rarity (e.g., common=5‚Äì10, rare=15‚Äì25, amazing=30‚Äì40, legendary=50+).
      - Create DOM element styled accordingly and append to scene container.

---

## 4. Visual Plan (Layout, Colors, Presentation)

### 4.1 Overall Layout

- **Aspect Ratio**: Aim for 9:16 (mobile portrait). Use a central container with `max-width` and `max-height` in viewport units.

- **Main areas**:
  - Top HUD:
    - Left: Round indicator (optional).
    - Center: Main counter (coins or fish, depending on phase).
    - Right: Potential mute icon (optional).
  - Middle Scene:
    - Water area with gradient background.
    - Hook from top, fish within water.
    - Fisherman boat silhouette on surface for context (simple rectangle/triangles).
  - Bottom Controls:
    - Gauge + Play button.
    - Upgrade buttons above or side of Play, but within thumb reach.

### 4.2 Color Palette (Friendly, Clear Contrast)

- Background:
  - Water gradient: `#0f3057` (deep) to `#0099cc` (near surface).
  - Sky: lighter gradient above waterline, `#87ceeb` to `#e0f7ff`.
- HUD:
  - Panels: semi-transparent dark (`rgba(0,0,0,0.4)`) with rounded corners.
  - Text: white `#ffffff` with slight shadow for readability.
- Coins:
  - Icon + burst: gold `#f5c542` with darker rim `#c79224`.
- Fish:
  - Common: neutral blues/greens (`#4db6ac`, `#64b5f6`).
  - Rare: warm accent (`#ff9800`).
  - Amazing: bright violet (`#ab47bc`).
  - Legendary: gold/teal (`#ffd700`, `#26c6da`).
- Gauge:
  - Background track: `#1a237e` with subtle inner shadow.
  - Fill/indicator: `#ffeb3b` for pointer, minor glow.

### 4.3 Visual Hierarchy & Placement

- **Counters**:
  - Top center, large num with icon:
    - State A: Coins:
      - Icon: coin glyph or simple circle.
      - Label: none or subtle ‚ÄúCoins‚Äù.
    - State B: Fish:
      - Fish icon and ‚ÄúX / maxFish‚Äù.
      - Under it a thin progress bar (2‚Äì3px height) with rounded ends showing catch progress.
- **Gauge & Play**:
  - Position gauge horizontally at bottom center.
  - Place Play button just above gauge center:
    - When resting: text ‚ÄúCAST‚Äù or ‚ÄúPLAY‚Äù.
    - When pointer moving: entire area is clickable.
- **Upgrades**:
  - Two rectangular buttons above the gauge or side by side:
    - Left: ‚ÄúMax Fish‚Äù.
    - Right: ‚ÄúMax Depth‚Äù.
  - Each shows:
    - Current value (e.g., ‚ÄúMax Fish: 6‚Äù).
    - Next tier cost (small text with coin icon ‚ÄúNext: 7 (50ü™ô)‚Äù).
  - Disabled state: dimmed + ‚ÄúMAX‚Äù label when no more upgrades.

### 4.4 Fake 3D Look

- Fisherman/boat:
  - Boat: simple trapezoid with perspective using CSS transform (`rotateX`, `skew`).
  - Fisherman: stacked rectangles/circles.
- Hook:
  - Vertical line (`div` with background) plus small rectangle or triangle as hook.
  - Slight drop shadow and gradient to suggest volume.
- Fish:
  - Simple rounded rectangles/ovals with fins as small triangles.
  - Use gentle rotation and scale to simulate depth variation.
  - Some vertical bobbing animation via CSS keyframes.

### 4.5 Feedback Effects

- When catching fish:
  - Quick scale-up then down (0.15‚Äì0.2s) on hook container.
  - Floating text (value + ‚ÄúRARE!‚Äù etc.) rising ~30px and fading.
- Summary coins:
  - Small coin circles that move from fish to top coin counter.
- Tutorial label:
  - Center overlay near hook depth:
    - Rounded rectangle with text ‚ÄúDrag to move the hook and catch fish‚Äù.
    - Semi-transparent dark background with white text.

---

## 5. Step-by-Step Implementation Plan

### 5.1 HTML Skeleton

1. Create minimal HTML:

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Fishing In The Deep</title>
  <style>
    /* (Implement from CSS plan; see below) */
  </style>
</head>
<body>
  <div id="game-root">
    <!-- HUD -->
    <div id="hud">
      <div id="round-indicator"></div>
      <div id="main-counter">
        <span id="counter-icon"></span>
        <span id="counter-value"></span>
      </div>
    </div>

    <!-- Scene -->
    <div id="scene-container">
      <div id="sky"></div>
      <div id="water">
        <div id="boat"></div>
        <div id="camera">
          <div id="hook"></div>
          <div id="fish-layer"></div>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div id="controls">
      <div id="upgrades">
        <button id="btn-upgrade-fish"></button>
        <button id="btn-upgrade-depth"></button>
      </div>
      <div id="gauge-container">
        <div id="gauge-track">
          <div id="gauge-pointer"></div>
        </div>
        <button id="btn-play">CAST</button>
      </div>
    </div>

    <!-- Fish counter bar (under main counter) -->
    <div id="fish-progress" class="hidden">
      <div id="fish-progress-fill"></div>
    </div>

    <!-- Overlays -->
    <div id="tutorial-overlay" class="hidden"></div>
    <div id="summary-overlay" class="hidden">
      <div id="summary-content">
        <div id="summary-title"></div>
        <div id="summary-amount"></div>
        <button id="summary-continue-btn">Next</button>
      </div>
    </div>

    <div id="end-screen" class="hidden">
      <div id="end-title">Fishing Complete!</div>
      <div id="end-coins"></div>
      <button id="end-cta">Play Full Game</button>
    </div>
  </div>

  <script>
    // (JS logic to be implemented)
  </script>
</body>
</html>
```

### 5.2 CSS Implementation

2. Define base styles:
   - `body, html` full-viewport; center `#game-root`; no scroll; background dark.
3. `#game-root`:
   - Fixed aspect ratio using `height: 100vh; width: 100vw;` and `max-width: 600px` for mobile; center with margin auto.
   - Position `relative; overflow: hidden`.
4. HUD:
   - `position: absolute; top: 0; width: 100%; display: flex; justify-content: center; padding: 8px`.
   - Stylize `#main-counter` as a pill with icon and number.
   - `#fish-progress` placed under counter with slim bar.
5. Scene:
   - `#scene-container` takes middle area.
   - `#water` with vertical gradient, `position: relative; overflow: hidden`.
   - `#camera` absolute container to move vertically.
   - `#hook` as tall narrow `div` with a small bottom hook shape.
   - `#fish-layer` holds fish; children positioned absolute.
6. Controls:
   - `#controls` anchored bottom, `display: flex; flex-direction: column; align-items: center; gap: 8px;`.
   - Upgrade buttons side-by-side; style with icon and text.
   - Gauge:
     - `#gauge-track` relative, full width, 8‚Äì10px height, border-radius big.
     - `#gauge-pointer` small circular or vertical bar, absolutely positioned.
     - `#btn-play` overlaying or just above.
7. Overlays:
   - `#tutorial-overlay`, `#summary-overlay`, `#end-screen` as `position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.5);`.
   - Inner content boxes with padding and rounded corners.
8. Helpers:
   - `.hidden { display: none; }`
   - `.fade-in` / `.fade-out` optional transitions.

### 5.3 JavaScript ‚Äì Initialization

3. In `<script>`:
   - Grab DOM elements via `document.getElementById`.
   - Initialize `GameState` as described.
   - Create modules:

```js
const UIManager = (function() {
  // cache DOM refs
  // functions: updateCounters(), showFishCounter(), showCoinCounter(), updateUpgrades(), showTutorial(), showSummary(), showEndScreen()
  return { /* public methods */ };
})();

const FishManager = (function() {
  let fishes = [];
  function generateField(maxDepth) { /* create Fish DOMs, push to fishes */ }
  function reset() { /* remove DOMs, clear array */ }
  function getFishes() { return fishes; }
  return { generateField, reset, getFishes };
})();

const FishingController = (function() {
  // state: hookY, hookX, targetDepth, verticalSpeed, phase-specific flags
  // functions: startRound(depth), update(dt), handlePointerMove
  return { startRound, update, onPointerDown, onPointerMove, onPointerUp };
})();

const UpgradeSystem = (function() {
  function tryUpgradeFish() { /* cost check, state update, UIManager update */ }
  function tryUpgradeDepth() { /* same */ }
  return { tryUpgradeFish, tryUpgradeDepth };
})();
```

4. Attach event listeners:
   - `btn-play` click ‚Üí start gauge / lock gauge depending on phase.
   - `btn-upgrade-fish` click ‚Üí `UpgradeSystem.tryUpgradeFish()`.
   - `btn-upgrade-depth` click ‚Üí `UpgradeSystem.tryUpgradeDepth()`.
   - `summary-continue-btn` ‚Üí advance round/end.
   - `end-cta` ‚Üí stub or analytic event.
   - Scene pointer events:
     - Attach `touchstart/mousedown` on `scene-container` during `"HOOK_ASCENDING"`; pass to `FishingController`.

### 5.4 Gauge Logic Implementation

5. Gauge:
   - Maintain:
     - `let gaugeTime = 0;`
     - `let gaugeDirection = 1;` (left-right)
   - In main update loop when `GameState.phase === 'GAUGE_SELECT'`:
     - `gaugeTime += dt * speed;`
     - Use simple ping-pong:
       - `progress = (Math.sin(gaugeTime) + 1) / 2;` or manual reversal when reaching 0/1.
   - Apply to DOM:
     - `gaugePointer.style.left = (progress * 100) + '%';`
   - On play button click when in `"LOBBY"`:
     - Set `GameState.phase = 'GAUGE_SELECT'`.
   - On second click/tap (or same button) when `"GAUGE_SELECT"`:
     - Lock `progress`, map to depth, `FishingController.startRound(selectedDepth)`.

### 5.5 FishingController ‚Äì Movement & Phases

6. Implement `startRound(depth)`:
   - Store `GameState.selectedDepth = depth`.
   - Set `hookY = 0; targetHookY = depthToY(depth);`.
   - Reset hookX to center.
   - `FishManager.generateField(GameState.maxDepth)`.
   - Switch counters: `UIManager.showFishCounter(GameState.maxFish)`.
   - `GameState.caughtFishThisRound = [];`
   - `GameState.phase = 'HOOK_DESCENDING'`.

7. Update function:
   - `if phase === 'HOOK_DESCENDING'`:
     - Move `hookY` towards `targetHookY` with speed.
     - Move `camera` DOM: `camera.style.transform = 'translateY(' + (-hookY) + 'px)'`.
     - On reaching target (check small threshold), set timer and phase `"HOOK_AT_DEPTH"`; call `UIManager.maybeShowTutorial(round===1)`.
   - `if phase === 'HOOK_AT_DEPTH'`:
     - Decrease hold timer; when ‚â§ 0:
       - `GameState.phase = 'HOOK_ASCENDING'`.
   - `if phase === 'HOOK_ASCENDING'`:
     - Move `hookY` upwards (decreasing).
     - Update `camera` accordingly.
     - Check for collisions with fishes from `FishManager.getFishes()`.
     - If fish caught count == `GameState.maxFish` ‚Üí `GameState.phase = 'RETURNING_FAST'`.
     - If hookY >= 0 (surface) with < max fish (happens if player missed) ‚Üí treat equivalent to finishing; send to `"AT_SURFACE_RESOLVE"`.
   - `if phase === 'RETURNING_FAST'`:
     - Increase vertical speed; ignore collisions.
     - When near surface, `UIManager.showCoinCounter()`.
     - On surface, `GameState.phase = 'AT_SURFACE_RESOLVE'` and `UIManager.showSummary(...)`.
   - `if phase === 'AT_SURFACE_RESOLVE'`:
     - Most logic is in UIManager animations; once done, call back to game to proceed.

8. Hook drag input:
   - On pointer down: record lastX.
   - On move: compute deltaX; set `hookX = clamp(hookX + delta, minX, maxX)`; apply DOM transform to hook container (`translateX`).
   - On up: stop.

### 5.6 FishManager ‚Äì Spawning & Catch Logic

9. `generateField(maxDepth)`:
   - Remove old fishes.
   - Number of fish e.g. `const count = Math.round(maxDepth * 2) + 10;`.
   - For i in [0..count):
     - `depth = random(0, maxDepth); y = depthToY(depth)` with some noise.
     - `x = random(minX, maxX)`.
     - Determine rarity:
       - `if depth < 8` ‚Üí mostly common.
       - `if depth between 8‚Äì18` ‚Üí mix.
       - `if depth > 18` ‚Üí more rare+legendary.
     - Create `div` for fish:
       - Absolute position with `transform: translate(x, y)`.
       - Add class by rarity for color.
     - Create `Fish` instance and push to array.

10. Catch detection (in FishingController):
   - `for each fish`:
     - If not `caught` and distance threshold, then:
       - `fish.caught = true`;
       - Push to `GameState.caughtFishThisRound`.
       - Move `fish.dom` under `hook`:
         - `hook.appendChild(fish.dom);`
         - Apply an offset so multiple fish are visible.
       - Trigger `Effects.onFishCaught(fish)`:
         - Floating text and bounce.

### 5.7 UI & Effects Implementation

11. `UIManager`:
   - `updateCounters()`:
     - If in coin mode:
       - `counter-icon` = coin icon; `counter-value` = `GameState.coins`.
     - If in fish mode:
       - `counter-icon` = fish icon; `counter-value` = `caughtFish / maxFish`.
   - `showFishCounter(maxFish)`:
     - Show fish progress bar; set fill to 0%.
   - `updateFishProgress(caught, max)`:
     - `fillWidth = (caught/max) * 100%`.
   - `showCoinCounter()`:
     - Hide fish progress; display coins again using current `GameState.coins`.
   - `updateUpgrades()`:
     - If upgrade possible, show cost; else ‚ÄúMAX‚Äù and disabled class.
   - `maybeShowTutorial(isFirstRound)`:
     - If `true`, show `tutorial-overlay` with message and timed fade-out.

12. Summary overlay:
   - `showSummary(caughtFish)`:
     - Compute total; store `roundTotal`.
     - Simple UI: show big `+roundTotal` and maybe small list if space.
     - Animate number counting from 0 to `roundTotal` over ~0.7s.
     - On complete, call `Effects.flyCoinsToCounter(roundTotal, onComplete)`.
   - On coins fly completion:
     - Increment `GameState.coins`.
     - `UIManager.updateCounters()`.
     - Show ‚ÄúNext‚Äù button; clicking triggers `advanceRound()`.

13. `Effects`:
   - Methods:
     - `onFishCaught(fish)`:
       - Create text element near hook with `+fish.value` and label (rare/amazing/legendary).
       - Animate upward and fade; remove after.
       - Slightly scale hook up & down.
     - `flyCoinsToCounter(amount, onComplete)`:
       - Spawn few coin elements at summary text position.
       - Animate them toward top HUD position by computing difference in screen coords (use `getBoundingClientRect()` once).
       - On end, call `onComplete`.

### 5.8 Rounds & End Screen

14. After summary complete:
   - `if GameState.round < GameState.maxRounds`:
     - `GameState.round++`.
     - `FishManager.reset();`
     - Reset hook position and camera.
     - Reset UI to lobby mode and gauge.
     - `GameState.phase = 'LOBBY'`.
   - Else:
     - `GameState.phase = 'END_SCREEN'`.
     - `UIManager.showEndScreen(GameState.coins)`:
       - Show final coin total and maybe a simple grade message.

### 5.9 Main Loop Hookup

15. Implement animation loop:

```js
let lastTime = 0;
function gameLoop(timestamp) {
  const dt = (timestamp - lastTime) / 1000; // seconds
  lastTime = timestamp;

  // Update systems
  if (GameState.phase === 'GAUGE_SELECT') {
    // update gauge pointer pos
  }
  FishingController.update(dt);
  AnimationManager.update(dt); // generic tweens if you implement them

  requestAnimationFrame(gameLoop);
}

requestAnimationFrame((t) => { lastTime = t; gameLoop(t); });
```

### 5.10 Testing & Tuning

16. Test flows:
   - Upgrades:
     - Verify costs, max levels, coin updates, disabled states.
   - Gauge:
     - Verify min depth = maxDepth - 2; pointer extremes map correctly.
   - Fishing:
     - Ensure tutorial appears only in first round.
     - Check fish catching is responsive and limited to maxFish.
   - Summary:
     - Verify fish values accumulate; coins update correctly; transitions to next round/end.
17. Tune:
   - Vertical speed vs depth (to keep rounds short but satisfying).
   - Drag sensitivity horizontally.
   - Fish density and values to make 3 rounds feel rewarding.

---

This plan yields a small, fully self-contained HTML playable with clear structure, low asset overhead, and easily adjustable gameplay parameters.
```